# üåü Sihatod: Secure Content-Addressable Storage (v3.0)

**Sihatod** ‚Äî —ç—Ç–æ –≤—ã—Å–æ–∫–æ–∑–∞—â–∏—â–µ–Ω–Ω–æ–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **Zero Trust Architecture**. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—á–∏–Ω–∞—è –æ—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–ª–æ—è –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è —Å—Ç—Ä–æ–≥–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π –≤–ª–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏.

## üõ°Ô∏è –≠—à–µ–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ (Defense in Depth)

–ü—Ä–æ–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ü–∞ 2025 ‚Äì –Ω–∞—á–∞–ª–∞ 2026 –≥–æ–¥–∞:

### –£—Ä–æ–≤–µ–Ω—å 1: –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (Zero Trust Network)

* **mTLS (Mutual TLS):** –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É FastAPI –∏ Redis. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–≤–µ—Ä—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏–∏ –≤–∞–ª–∏–¥–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.
* 
**Redis Security:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ACL (Access Control Lists) –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö –ø–∞—Ä–æ–ª–µ–π. –û–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (`FLUSHALL`, `CONFIG`) –æ—Ç–∫–ª—é—á–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.



### –£—Ä–æ–≤–µ–Ω—å 2: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Hardened Container)

* 
**Rootless Docker:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `sihatoduser` (UID 10001).


* **Minimal Attack Surface:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Python 3.14-slim –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —à–µ–ª–ª–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –£—Ä–æ–≤–µ–Ω—å 3: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Identity Management)

* **Ed25519 (EdDSA):** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö. –ë—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, —á–µ–º RSA/RSA-PSS.
* **Secure Cookies:** –¢–æ–∫–µ–Ω—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ `HttpOnly`, `Secure` –∏ `SameSite=Strict` Cookies. JavaScript –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Å—Å–∏–∏, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç XSS-–∫—Ä–∞–∂—É —Ç–æ–∫–µ–Ω–æ–≤.

### –£—Ä–æ–≤–µ–Ω—å 4: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (API Shield)

* **Security Headers:** –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (HSTS, CSP, X-Frame-Options) –¥–ª—è –∑–∞—â–∏—Ç—ã –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
* **Rate Limiting:** –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ Redis-–ª–∏–º–∏—Ç–µ—Ä –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç brute-force –∏ DoS-–∞—Ç–∞–∫.
* **Strict Validation:** Pydantic V2 Strict Mode –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ—Ç—É –≤—Ö–æ–¥—è—â–∏—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

## üì¶ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–π

–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (CA) –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
python generate_certs.py

```

*–§–∞–π–ª—ã –≤ `certs/` –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—Ä–æ—à–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —á–µ—Ä–µ–∑ volumes.*

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞. **–í–∞–∂–Ω–æ:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Ç–æ–∫–æ–ª `rediss://` –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ TLS:

```env
REDIS_URL=rediss://sihatod_app:SuperSecurePass2026@redis:6379/0

```

### 3. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è

–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:

```bash
docker-compose up --build -d

```

## üõ†Ô∏è API & –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π

### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (SDK)

–î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `do_business_logic.py`. –û–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç `SihatodSecureClient` ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π:

1. –í—ã–ø–æ–ª–Ω—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π Login.
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ Cookies.
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞.

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (PowerShell)

**–ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö:**

```powershell
Invoke-RestMethod -Method Put -Uri "https://localhost:5001/hash/user_1/balance?value=100500"

```

## üß™ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

* **Core:** Python 3.14+, FastAPI.
* **Storage:** Redis 7.2+ (ACL + TLS).
* **Security:** Cryptography (X.509), PyJWT (Ed25519).
* **DevOps:** Docker (Rootless), Poetry.

---

### üìù –õ–æ–≥ –∞—É–¥–∏—Ç–∞

–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è ACL –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ (Rate Limit) –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É—Ä–æ–≤–Ω–µ–º `WARNING` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

---